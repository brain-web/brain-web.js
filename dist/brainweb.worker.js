(()=>{var t={485:(t,e,r)=>{t.exports=r(894)},894:function(t,e){var r,n,o;(function(){var i,s,h,a,u,l,f,c,p,m,g,w,d,y,v;h=Math.floor,m=Math.min,s=function(t,e){return t<e?-1:t>e?1:0},p=function(t,e,r,n,o){var i;if(null==r&&(r=0),null==o&&(o=s),r<0)throw new Error("lo must be non-negative");for(null==n&&(n=t.length);r<n;)o(e,t[i=h((r+n)/2)])<0?n=i:r=i+1;return[].splice.apply(t,[r,r-r].concat(e)),e},l=function(t,e,r){return null==r&&(r=s),t.push(e),y(t,0,t.length-1,r)},u=function(t,e){var r,n;return null==e&&(e=s),r=t.pop(),t.length?(n=t[0],t[0]=r,v(t,0,e)):n=r,n},c=function(t,e,r){var n;return null==r&&(r=s),n=t[0],t[0]=e,v(t,0,r),n},f=function(t,e,r){var n;return null==r&&(r=s),t.length&&r(t[0],e)<0&&(e=(n=[t[0],e])[0],t[0]=n[1],v(t,0,r)),e},a=function(t,e){var r,n,o,i,a,u;for(null==e&&(e=s),a=[],n=0,o=(i=function(){u=[];for(var e=0,r=h(t.length/2);0<=r?e<r:e>r;0<=r?e++:e--)u.push(e);return u}.apply(this).reverse()).length;n<o;n++)r=i[n],a.push(v(t,r,e));return a},d=function(t,e,r){var n;if(null==r&&(r=s),-1!==(n=t.indexOf(e)))return y(t,0,n,r),v(t,n,r)},g=function(t,e,r){var n,o,i,h,u;if(null==r&&(r=s),!(o=t.slice(0,e)).length)return o;for(a(o,r),i=0,h=(u=t.slice(e)).length;i<h;i++)n=u[i],f(o,n,r);return o.sort(r).reverse()},w=function(t,e,r){var n,o,i,h,l,f,c,g,w;if(null==r&&(r=s),10*e<=t.length){if(!(i=t.slice(0,e).sort(r)).length)return i;for(o=i[i.length-1],h=0,f=(c=t.slice(e)).length;h<f;h++)r(n=c[h],o)<0&&(p(i,n,0,null,r),i.pop(),o=i[i.length-1]);return i}for(a(t,r),w=[],l=0,g=m(e,t.length);0<=g?l<g:l>g;0<=g?++l:--l)w.push(u(t,r));return w},y=function(t,e,r,n){var o,i,h;for(null==n&&(n=s),o=t[r];r>e&&n(o,i=t[h=r-1>>1])<0;)t[r]=i,r=h;return t[r]=o},v=function(t,e,r){var n,o,i,h,a;for(null==r&&(r=s),o=t.length,a=e,i=t[e],n=2*e+1;n<o;)(h=n+1)<o&&!(r(t[n],t[h])<0)&&(n=h),t[e]=t[n],n=2*(e=n)+1;return t[e]=i,y(t,a,e,r)},i=function(){function t(t){this.cmp=null!=t?t:s,this.nodes=[]}return t.push=l,t.pop=u,t.replace=c,t.pushpop=f,t.heapify=a,t.updateItem=d,t.nlargest=g,t.nsmallest=w,t.prototype.push=function(t){return l(this.nodes,t,this.cmp)},t.prototype.pop=function(){return u(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return c(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return f(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return a(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return d(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),n=[],void 0===(o="function"==typeof(r=function(){return i})?r.apply(e,n):r)||(t.exports=o)}).call(this)},726:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>p});const n=Object.prototype.toString;function o(t){return n.call(t).endsWith("Array]")}function i(t,e,r){let n=0;const o=r(e);for(let e=0;e<t.x.length;e++)n+=Math.abs(t.y[e]-o(t.x[e]));return n}var s=r(754);class h extends s.X{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class a{constructor(t){let e,r,n,o,i,s,a,u,l,f=(t=h.checkMatrix(t)).clone(),c=f.rows,p=f.columns,m=new Float64Array(c),g=1;for(e=0;e<c;e++)m[e]=e;for(u=new Float64Array(c),r=0;r<p;r++){for(e=0;e<c;e++)u[e]=f.get(e,r);for(e=0;e<c;e++){for(l=Math.min(e,r),i=0,n=0;n<l;n++)i+=f.get(e,n)*u[n];u[e]-=i,f.set(e,r,u[e])}for(o=r,e=r+1;e<c;e++)Math.abs(u[e])>Math.abs(u[o])&&(o=e);if(o!==r){for(n=0;n<p;n++)s=f.get(o,n),f.set(o,n,f.get(r,n)),f.set(r,n,s);a=m[o],m[o]=m[r],m[r]=a,g=-g}if(r<c&&0!==f.get(r,r))for(e=r+1;e<c;e++)f.set(e,r,f.get(e,r)/f.get(r,r))}this.LU=f,this.pivotVector=m,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=s.Z.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,o,i=t.columns,h=t.subMatrixRow(this.pivotVector,0,i-1),a=e.columns;for(o=0;o<a;o++)for(r=o+1;r<a;r++)for(n=0;n<i;n++)h.set(r,n,h.get(r,n)-h.get(o,n)*e.get(r,o));for(o=a-1;o>=0;o--){for(n=0;n<i;n++)h.set(o,n,h.get(o,n)/e.get(o,o));for(r=0;r<o;r++)for(n=0;n<i;n++)h.set(r,n,h.get(r,n)-h.get(o,n)*e.get(r,o))}return h}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new s.Z(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o>e?n.set(o,e,t.get(o,e)):o===e?n.set(o,e,1):n.set(o,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new s.Z(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o<=e?n.set(o,e,t.get(o,e)):n.set(o,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function u(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class l{constructor(t){let e,r,n,o,i=(t=h.checkMatrix(t)).clone(),s=t.rows,a=t.columns,l=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<s;e++)t=u(t,i.get(e,n));if(0!==t){for(i.get(n,n)<0&&(t=-t),e=n;e<s;e++)i.set(e,n,i.get(e,n)/t);for(i.set(n,n,i.get(n,n)+1),r=n+1;r<a;r++){for(o=0,e=n;e<s;e++)o+=i.get(e,n)*i.get(e,r);for(o=-o/i.get(n,n),e=n;e<s;e++)i.set(e,r,i.get(e,r)+o*i.get(e,n))}}l[n]=-t}this.QR=i,this.Rdiag=l}solve(t){t=s.Z.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,o,i,h,a=t.columns,u=t.clone(),l=e.columns;for(i=0;i<l;i++)for(o=0;o<a;o++){for(h=0,n=i;n<r;n++)h+=e.get(n,i)*u.get(n,o);for(h=-h/e.get(i,i),n=i;n<r;n++)u.set(n,o,u.get(n,o)+h*e.get(n,i))}for(i=l-1;i>=0;i--){for(o=0;o<a;o++)u.set(i,o,u.get(i,o)/this.Rdiag[i]);for(n=0;n<i;n++)for(o=0;o<a;o++)u.set(n,o,u.get(n,o)-u.get(i,o)*e.get(n,i))}return u.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,o=new s.Z(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?o.set(t,e,r.get(t,e)):t===e?o.set(t,e,this.Rdiag[t]):o.set(t,e,0);return o}get orthogonalMatrix(){let t,e,r,n,o=this.QR,i=o.rows,h=o.columns,a=new s.Z(i,h);for(r=h-1;r>=0;r--){for(t=0;t<i;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<h;e++)if(0!==o.get(r,r)){for(n=0,t=r;t<i;t++)n+=o.get(t,r)*a.get(t,e);for(n=-n/o.get(r,r),t=r;t<i;t++)a.set(t,e,a.get(t,e)+n*o.get(t,r))}}return a}}class f{constructor(t,e={}){if((t=h.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=e;let l,f=Boolean(o),c=Boolean(i),p=!1;if(r<n)if(a){l=t.transpose(),r=l.rows,n=l.columns,p=!0;let e=f;f=c,c=e}else l=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else l=t.clone();let m=Math.min(r,n),g=Math.min(r+1,n),w=new Float64Array(g),d=new s.Z(r,m),y=new s.Z(n,n),v=new Float64Array(n),b=new Float64Array(r),M=new Float64Array(g);for(let t=0;t<g;t++)M[t]=t;let x=Math.min(r-1,n),S=Math.max(0,Math.min(n-2,r)),E=Math.max(x,S);for(let t=0;t<E;t++){if(t<x){w[t]=0;for(let e=t;e<r;e++)w[t]=u(w[t],l.get(e,t));if(0!==w[t]){l.get(t,t)<0&&(w[t]=-w[t]);for(let e=t;e<r;e++)l.set(e,t,l.get(e,t)/w[t]);l.set(t,t,l.get(t,t)+1)}w[t]=-w[t]}for(let e=t+1;e<n;e++){if(t<x&&0!==w[t]){let n=0;for(let o=t;o<r;o++)n+=l.get(o,t)*l.get(o,e);n=-n/l.get(t,t);for(let o=t;o<r;o++)l.set(o,e,l.get(o,e)+n*l.get(o,t))}v[e]=l.get(t,e)}if(f&&t<x)for(let e=t;e<r;e++)d.set(e,t,l.get(e,t));if(t<S){v[t]=0;for(let e=t+1;e<n;e++)v[t]=u(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)b[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)b[e]+=v[r]*l.get(e,r);for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)l.set(o,e,l.get(o,e)+n*b[o])}}if(c)for(let e=t+1;e<n;e++)y.set(e,t,v[e])}}let R=Math.min(n,r+1);if(x<n&&(w[x]=l.get(x,x)),r<R&&(w[R-1]=0),S+1<R&&(v[S]=l.get(S,R-1)),v[R-1]=0,f){for(let t=x;t<m;t++){for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}for(let t=x-1;t>=0;t--)if(0!==w[t]){for(let e=t+1;e<m;e++){let n=0;for(let o=t;o<r;o++)n+=d.get(o,t)*d.get(o,e);n=-n/d.get(t,t);for(let o=t;o<r;o++)d.set(o,e,d.get(o,e)+n*d.get(o,t))}for(let e=t;e<r;e++)d.set(e,t,-d.get(e,t));d.set(t,t,1+d.get(t,t));for(let e=0;e<t-1;e++)d.set(e,t,0)}else{for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}}if(c)for(let t=n-1;t>=0;t--){if(t<S&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=y.get(o,t)*y.get(o,e);r=-r/y.get(t+1,t);for(let o=t+1;o<n;o++)y.set(o,e,y.get(o,e)+r*y.get(o,t))}for(let e=0;e<n;e++)y.set(e,t,0);y.set(t,t,1)}let k=R-1,N=0,z=Number.EPSILON;for(;R>0;){let t,e;for(t=R-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+z*Math.abs(w[t]+Math.abs(w[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===R-2)e=4;else{let r;for(r=R-1;r>=t&&r!==t;r--){let e=(r!==R?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(w[r])<=z*e){w[r]=0;break}}r===t?e=3:r===R-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[R-2];v[R-2]=0;for(let r=R-2;r>=t;r--){let o=u(w[r],e),i=w[r]/o,s=e/o;if(w[r]=o,r!==t&&(e=-s*v[r-1],v[r-1]=i*v[r-1]),c)for(let t=0;t<n;t++)o=i*y.get(t,r)+s*y.get(t,R-1),y.set(t,R-1,-s*y.get(t,r)+i*y.get(t,R-1)),y.set(t,r,o)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<R;n++){let o=u(w[n],e),i=w[n]/o,s=e/o;if(w[n]=o,e=-s*v[n],v[n]=i*v[n],f)for(let e=0;e<r;e++)o=i*d.get(e,n)+s*d.get(e,t-1),d.set(e,t-1,-s*d.get(e,n)+i*d.get(e,t-1)),d.set(e,n,o)}break}case 3:{const e=Math.max(Math.abs(w[R-1]),Math.abs(w[R-2]),Math.abs(v[R-2]),Math.abs(w[t]),Math.abs(v[t])),o=w[R-1]/e,i=w[R-2]/e,s=v[R-2]/e,h=w[t]/e,a=v[t]/e,l=((i+o)*(i-o)+s*s)/2,p=o*s*(o*s);let m=0;0===l&&0===p||(m=l<0?0-Math.sqrt(l*l+p):Math.sqrt(l*l+p),m=p/(l+m));let g=(h+o)*(h-o)+m,b=h*a;for(let e=t;e<R-1;e++){let o=u(g,b);0===o&&(o=Number.MIN_VALUE);let i=g/o,s=b/o;if(e!==t&&(v[e-1]=o),g=i*w[e]+s*v[e],v[e]=i*v[e]-s*w[e],b=s*w[e+1],w[e+1]=i*w[e+1],c)for(let t=0;t<n;t++)o=i*y.get(t,e)+s*y.get(t,e+1),y.set(t,e+1,-s*y.get(t,e)+i*y.get(t,e+1)),y.set(t,e,o);if(o=u(g,b),0===o&&(o=Number.MIN_VALUE),i=g/o,s=b/o,w[e]=o,g=i*v[e]+s*w[e+1],w[e+1]=-s*v[e]+i*w[e+1],b=s*v[e+1],v[e+1]=i*v[e+1],f&&e<r-1)for(let t=0;t<r;t++)o=i*d.get(t,e)+s*d.get(t,e+1),d.set(t,e+1,-s*d.get(t,e)+i*d.get(t,e+1)),d.set(t,e,o)}v[R-2]=g,N+=1;break}case 4:if(w[t]<=0&&(w[t]=w[t]<0?-w[t]:0,c))for(let e=0;e<=k;e++)y.set(e,t,-y.get(e,t));for(;t<k&&!(w[t]>=w[t+1]);){let e=w[t];if(w[t]=w[t+1],w[t+1]=e,c&&t<n-1)for(let r=0;r<n;r++)e=y.get(r,t+1),y.set(r,t+1,y.get(r,t)),y.set(r,t,e);if(f&&t<r-1)for(let n=0;n<r;n++)e=d.get(n,t+1),d.set(n,t+1,d.get(n,t)),d.set(n,t,e);t++}N=0,R--}}if(p){let t=y;y=d,d=t}this.m=r,this.n=n,this.s=w,this.U=d,this.V=y}solve(t){let e=t,r=this.threshold,n=this.s.length,o=s.Z.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o.set(t,t,0):o.set(t,t,1/this.s[t]);let i=this.U,h=this.rightSingularVectors,a=h.mmul(o),u=h.rows,l=i.rows,f=s.Z.zeros(u,l);for(let t=0;t<u;t++)for(let e=0;e<l;e++){let r=0;for(let o=0;o<n;o++)r+=a.get(t,o)*i.get(e,o);f.set(t,e,r)}return f.mmul(e)}solveForDiagonal(t){return this.solve(s.Z.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,o=new s.Z(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,h=i.rows,a=i.columns,u=new s.Z(r,h);for(let t=0;t<r;t++)for(let e=0;e<h;e++){let r=0;for(let n=0;n<a;n++)r+=o.get(t,n)*i.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return s.Z.diag(this.s)}}function c(t,e,r,n,o){let i=r*n*n,u=s.Z.eye(e.length,e.length,i);const c=o(e);let p=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)p[e]=c(t.x[e]);let m=function(t,e,r,n,o){const i=r.length,h=t.x.length;let a=new Array(i);for(let s=0;s<i;s++){a[s]=new Array(h);let i=r.slice();i[s]+=n;let u=o(i);for(let r=0;r<h;r++)a[s][r]=e[r]-u(t.x[r])}return new s.Z(a)}(t,p,e,n,o),g=function(t,e){const r=t.x.length;let n=new Array(r);for(let o=0;o<r;o++)n[o]=[t.y[o]-e[o]];return new s.Z(n)}(t,p),w=function(t,e=!1){return t=h.checkMatrix(t),e?new f(t).inverse():function(t,e,r=!1){return t=h.checkMatrix(t),e=h.checkMatrix(e),r?new f(t).solve(e):t.isSquare()?new a(t).solve(e):new l(t).solve(e)}(t,s.Z.eye(t.rows))}(u.add(m.mmul(m.transpose())));return(e=(e=new s.Z([e])).sub(w.mmul(m).mmul(g).mul(n).transpose())).to1DArray()}function p(t,e,r={}){let{maxIterations:n=100,gradientDifference:s=.1,damping:h=0,errorTolerance:a=.01,minValues:u,maxValues:l,initialValues:f}=r;if(h<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!o(t.x)||t.x.length<2||!o(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let p=f||new Array(e.length).fill(1),m=p.length;if(l=l||new Array(m).fill(Number.MAX_SAFE_INTEGER),u=u||new Array(m).fill(Number.MIN_SAFE_INTEGER),l.length!==u.length)throw new Error("minValues and maxValues must be the same size");if(!o(p))throw new Error("initialValues must be an array");let g,w=i(t,p,e),d=w<=a;for(g=0;g<n&&!d;g++){p=c(t,p,h,s,e);for(let t=0;t<m;t++)p[t]=Math.min(Math.max(u[t],p[t]),l[t]);if(w=i(t,p,e),isNaN(w))break;d=w<=a}return{parameterValues:p,parameterError:w,iterations:g}}},754:(t,e,r)=>{"use strict";r.d(e,{X:()=>x,Z:()=>E});const n=Object.prototype.toString;function o(t){return n.call(t).endsWith("Array]")}const i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,s=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var h=t[n],a=n+1;a<s;a++)t[a]>h&&(h=t[a]);return h},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,s=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var h=t[n],a=n+1;a<s;a++)t[a]<h&&(h=t[a]);return h},h=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!o(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=s(t),h=i(t);if(n===h)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=r.min,u=void 0===a?r.autoMinMax?n:0:a,l=r.max,f=void 0===l?r.autoMinMax?h:1:l;if(u>=f)throw new RangeError("min option must be smaller than max option");for(var c=(f-u)/(h-n),p=0;p<t.length;p++)e[p]=(t[p]-n)*c+u;return e},a=" ".repeat(2),u=" ".repeat(4);function l(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:o=8}=e;return`${t.constructor.name} {\n${a}[\n${u}${function(t,e,r,n){const{rows:o,columns:i}=t,s=Math.min(o,e),h=Math.min(i,r),a=[];for(let e=0;e<s;e++){let r=[];for(let o=0;o<h;o++)r.push(f(t.get(e,o),n));a.push(`${r.join(" ")}`)}return h!==i&&(a[a.length-1]+=` ... ${i-r} more columns`),s!==o&&a.push(`... ${o-e} more rows`),a.join(`\n${u}`)}(t,r,n,o)}\n${a}]\n${a}rows: ${t.rows}\n${a}columns: ${t.columns}\n}`}function f(t,e){const r=String(t);if(r.length<=e)return r.padEnd(e," ");const n=t.toPrecision(e-2);if(n.length<=e)return n;const o=t.toExponential(e-2),i=o.indexOf("e"),s=o.slice(i);return o.slice(0,e-s.length)+s}function c(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function p(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function m(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function g(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function w(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some((e=>e<0||e>=t.rows)))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function d(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some((e=>e<0||e>=t.columns)))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function y(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(b("startRow",e),b("endRow",r),b("startColumn",n),b("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function v(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function b(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function M(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class x{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new E(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)n.set(o,t,r[o*e+t]);return n}static rowVector(t){let e=new E(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new E(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new E(t,e)}static ones(t,e){return new E(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let o=new E(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,n());return o}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(n>=o)throw new RangeError("min must be smaller than max");let s=o-n,h=new E(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(i()*s);h.set(r,t,e)}return h}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<n;t++)o.set(t,t,r);return o}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let o=Math.min(n,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new E(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,o=new this(r,n);for(let i=0;i<r;i++)for(let r=0;r<n;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return x.isMatrix(t)?t:new E(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(n,r)&&(n=o);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let o=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/o);for(let n=e+1;n<t.rows;n++){let o=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let i=r+1;i<t.columns;i++)t.set(n,i,t.get(n,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(n,o)?i=!0:o++;for(let r=0;r<n;r++){let i=t.get(r,o);for(let s=o;s<e;s++){let e=t.get(r,s)-i*t.get(n,s);t.set(r,s,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new E(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return E.rowVector(this.getRow(t))}setRow(t,e){c(this,t),e=m(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){c(this,t),c(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){p(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return E.columnVector(this.getColumn(t))}setColumn(t,e){p(this,t),e=g(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){p(this,t),p(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){c(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){p(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){if(this.isEmpty())return NaN;let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){M(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){if(this.isEmpty())return NaN;let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){M(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){c(this,t),M(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){c(this,t),M(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(p(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){p(this,t),M(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(p(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){p(this,t),M(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){x.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=E.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,o=new E(e,n),i=new Float64Array(r);for(let s=0;s<n;s++){for(let e=0;e<r;e++)i[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*i[n];o.set(t,s,e)}}return o}strassen2x2(t){t=E.checkMatrix(t);let e=new E(2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),s=this.get(1,0),h=t.get(1,0),a=this.get(1,1),u=t.get(1,1),l=(r+a)*(n+u),f=(s+a)*n,c=r*(i-u),p=a*(h-n),m=(r+o)*u,g=l+p-m+(o-a)*(h+u),w=c+m,d=f+p,y=l-f+c+(s-r)*(n+i);return e.set(0,0,g),e.set(0,1,w),e.set(1,0,d),e.set(1,1,y),e}strassen3x3(t){t=E.checkMatrix(t);let e=new E(3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),s=this.get(1,1),h=this.get(1,2),a=this.get(2,0),u=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),p=t.get(0,2),m=t.get(1,0),g=t.get(1,1),w=t.get(1,2),d=t.get(2,0),y=t.get(2,1),v=t.get(2,2),b=(r-i)*(-c+g),M=(-r+i+s)*(f-c+g),x=(i+s)*(-f+c),S=r*f,R=(-r+a+u)*(f-p+w),k=(-r+a)*(p-w),N=(a+u)*(-f+p),z=(-o+u+l)*(g+d-y),A=(o-l)*(g-y),C=o*d,I=(u+l)*(-d+y),P=(-o+s+h)*(w+d-v),F=(o-h)*(w-v),_=(s+h)*(-d+v),T=S+C+n*m,O=(r+n+o-i-s-u-l)*g+M+x+S+z+C+I,V=S+R+N+(r+n+o-s-h-a-u)*w+C+P+_,j=b+s*(-f+c+m-g-w-d+v)+M+S+C+P+F,q=b+M+x+S+h*y,D=C+P+F+_+i*p,L=S+R+k+u*(-f+p+m-g-w-d+y)+z+A+C,$=z+A+C+I+a*c,Z=S+R+k+N+l*v;return e.set(0,0,T),e.set(0,1,O),e.set(0,2,V),e.set(1,0,j),e.set(1,1,q),e.set(1,2,D),e.set(2,0,L),e.set(2,1,$),e.set(2,2,Z),e}mmulStrassen(t){t=E.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,o=t.rows,i=t.columns;function s(t,e,r){let n=t.rows,o=t.columns;if(n===e&&o===r)return t;{let n=x.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==o&&console.warn(`Multiplying ${r} x ${n} and ${o} x ${i} matrix: dimensions do not match.`);let h=Math.max(r,o),a=Math.max(n,i);return e=s(e,h,a),function t(e,r,n,o){if(n<=512||o<=512)return e.mmul(r);n%2==1&&o%2==1?(e=s(e,n+1,o+1),r=s(r,n+1,o+1)):n%2==1?(e=s(e,n+1,o),r=s(r,n+1,o)):o%2==1&&(e=s(e,n,o+1),r=s(r,n,o+1));let i=parseInt(e.rows/2,10),h=parseInt(e.columns/2,10),a=e.subMatrix(0,i-1,0,h-1),u=r.subMatrix(0,i-1,0,h-1),l=e.subMatrix(0,i-1,h,e.columns-1),f=r.subMatrix(0,i-1,h,r.columns-1),c=e.subMatrix(i,e.rows-1,0,h-1),p=r.subMatrix(i,r.rows-1,0,h-1),m=e.subMatrix(i,e.rows-1,h,e.columns-1),g=r.subMatrix(i,r.rows-1,h,r.columns-1),w=t(x.add(a,m),x.add(u,g),i,h),d=t(x.add(c,m),u,i,h),y=t(a,x.sub(f,g),i,h),v=t(m,x.sub(p,u),i,h),b=t(x.add(a,l),g,i,h),M=t(x.sub(c,a),x.add(u,f),i,h),S=t(x.sub(l,m),x.add(p,g),i,h),E=x.add(w,v);E.sub(b),E.add(S);let R=x.add(y,b),k=x.add(d,v),N=x.sub(w,d);N.add(y),N.add(M);let z=x.zeros(2*E.rows,2*E.columns);return z=z.setSubMatrix(E,0,0),z=z.setSubMatrix(R,E.rows,0),z=z.setSubMatrix(k,0,E.columns),z=z.setSubMatrix(N,E.rows,E.columns),z.subMatrix(0,n-1,0,o-1)}(e,t=s(t,h,a),h,a)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new E(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&h(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new E(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&h(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=E.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new E(e*n,r*o);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let h=0;h<o;h++)i.set(n*s+r,o*e+h,this.get(s,e)*t.get(r,h));return i}kroneckerSum(t){if(t=E.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(E.eye(r,r)),o=E.eye(e,e).kroneckerProduct(t);return n.add(o)}transpose(){let t=new E(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=S){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=S){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){y(this,t,e,r,n);let o=new E(e-t+1,n-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=n;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new E(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new E(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){if((t=E.checkMatrix(t)).isEmpty())return this;y(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let o=0;o<t.columns;o++)this.set(e+n,r+o,t.get(n,o));return this}selection(t,e){let r=function(t,e,r){return{row:w(t,e),column:d(t,r)}}(this,t,e),n=new E(t.length,e.length);for(let t=0;t<r.row.length;t++){let e=r.row[t];for(let o=0;o<r.column.length;o++){let i=r.column[o];n.set(t,o,this.get(e,i))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new E(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=v(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=v(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=v(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=v(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let s=0;s<n;s++){let n=0,h=0,a=0;for(let e=0;e<o;e++)a=t.get(s,e)-r[s],n+=a,h+=a*a;e?i.push((h-n*n/o)/(o-1)):i.push((h-n*n/o)/o)}return i}(this,r,n);case"column":if(!Array.isArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,o=t.columns,i=[];for(let s=0;s<o;s++){let o=0,h=0,a=0;for(let e=0;e<n;e++)a=t.get(e,s)-r[s],o+=a,h+=a*a;e?i.push((h-o*o/n)/(n-1)):i.push((h-o*o/n)/n)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,o=t.columns,i=n*o;let s=0,h=0,a=0;for(let e=0;e<n;e++)for(let n=0;n<o;n++)a=t.get(e,n)-r,s+=a,h+=a*a;return e?(h-s*s/i)/(i-1):(h-s*s/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return l(this,t)}}function S(t,e){return t-e}x.prototype.klass="Matrix","undefined"!=typeof Symbol&&(x.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return l(this)}),x.random=x.rand,x.randomInt=x.randInt,x.diagonal=x.diag,x.prototype.diagonal=x.prototype.diag,x.identity=x.eye,x.prototype.negate=x.prototype.neg,x.prototype.tensorProduct=x.prototype.kroneckerProduct;class E extends x{constructor(t,e){if(super(),E.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[n]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return c(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),c(this,t,!0),e=Float64Array.from(m(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){p(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),p(this,t,!0),e=g(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let o=0;for(;o<t;o++)n[o]=this.data[r][o];for(n[o++]=e[r];o<this.columns+1;o++)n[o]=this.data[r][o-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(x,E)},378:function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(517));function i(t,e){var r=function(r){return o.empty(t).map((function(){return o.filled(e,r)}))},n=[];return n.push(r(-1)),n.push(r(1/0)),n.push(r(0)),n}function s(t,e,r,n,o){e=Math.floor(e);var i=t[0][e],s=t[1][e];if(t[2][e],r>=s[0])return 0;for(var a=0;a<i.length;a++)if(n===i[a])return 0;return h(t,e,r,n,o)}function h(t,e,r,n,o){var i=t[0][e],s=t[1][e],h=t[2][e];if(r>=s[0])return 0;s[0]=r,i[0]=n,h[0]=o;for(var a=0,u=0;;){var l=2*a+1,f=l+1,c=t[0][0].length;if(l>=c)break;if(f>=c){if(!(s[l]>r))break;u=l}else if(s[l]>=s[f]){if(!(r<s[l]))break;u=l}else{if(!(r<s[f]))break;u=f}s[a]=s[u],i[a]=i[u],h[a]=h[u],a=u}return s[a]=r,i[a]=n,h[a]=o,1}function a(t,e,r,n){for(;2*n+1<r;){var o=2*n+1,i=o+1,s=n;if(t[s]<t[o]&&(s=o),i<r&&t[s]<t[i]&&(s=i),s===n)break;var h=t[n];t[n]=t[s],t[s]=h;var a=e[n];e[n]=e[s],e[s]=a,n=s}}e.makeHeap=i,e.rejectionSample=function(t,e,r){for(var n=o.zeros(t),i=0;i<t;i++){for(var s=!0,h=0;s;){h=o.tauRandInt(e,r);for(var a=!1,u=0;u<i;u++)if(h===n[u]){a=!0;break}a||(s=!1)}n[i]=h}return n},e.heapPush=s,e.uncheckedHeapPush=h,e.buildCandidates=function(t,e,r,n,h){for(var a=i(e,n),u=0;u<e;u++)for(var l=0;l<r;l++)if(!(t[0][u][l]<0)){var f=t[0][u][l],c=t[2][u][l],p=o.tauRand(h);s(a,u,p,f,c),s(a,f,p,u,c),t[2][u][l]=0}return a},e.deheapSort=function(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var o=e[n],i=r[n],s=0;s<o.length-1;s++){var h=o.length-s-1,u=i.length-s-1,l=o[0];o[0]=o[h],o[h]=l;var f=i[0];i[0]=i[u],i[u]=f,a(i,o,u,0)}return{indices:e,weights:r}},e.smallestFlagged=function(t,e){for(var r=t[0][e],n=t[1][e],o=t[2][e],i=1/0,s=-1,h=0;h>r.length;h++)1===o[h]&&n[h]<i&&(i=n[h],s=h);return s>=0?(o[s]=0,Math.floor(r[s])):-1}},221:(t,e,r)=>{"use strict";var n=r(364);e.u=n.UMAP},686:function(t,e,r){"use strict";var n,o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var h=s(r(517)),a=function(){function t(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var o=0;o<r.length;o++){var i=t[o],s=e[o];this.checkDims(i,s);var h=this.makeKey(i,s);this.entries.set(h,{value:r[o],row:i,col:s})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach((function(t){e.push(t)})),t&&e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row})),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,(function(t){var e=o(t,2);return e[0],e[1].row}))},t.prototype.getCols=function(){return Array.from(this.entries,(function(t){var e=o(t,2);return e[0],e[1].col}))},t.prototype.getValues=function(){return Array.from(this.entries,(function(t){var e=o(t,2);return e[0],e[1].value}))},t.prototype.forEach=function(t){this.entries.forEach((function(e){return t(e.value,e.row,e.col)}))},t.prototype.map=function(e){var r=[];this.entries.forEach((function(t){r.push(e(t.value,t.row,t.col))}));var n=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,n)},t.prototype.toArray=function(){var t=this,e=h.empty(this.nRows).map((function(){return h.zeros(t.nCols)}));return this.entries.forEach((function(t){e[t.row][t.col]=t.value})),e},t}();e.SparseMatrix=a,e.transpose=function(t){var e=[],r=[],n=[];t.forEach((function(t,o,i){e.push(o),r.push(i),n.push(t)}));var o=[t.nCols,t.nRows];return new a(r,e,n,o)},e.identity=function(t){for(var e=o(t,1)[0],r=new a([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r},e.pairwiseMultiply=function(t,e){return l(t,e,(function(t,e){return t*e}))},e.add=function(t,e){return l(t,e,(function(t,e){return t+e}))},e.subtract=function(t,e){return l(t,e,(function(t,e){return t-e}))},e.maximum=function(t,e){return l(t,e,(function(t,e){return t>e?t:e}))},e.multiplyScalar=function(t,e){return t.map((function(t){return t*e}))},e.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),o=t.getCols(),i=0;i<r.length;i++)0===r[i]&&e.add(i);var s=function(t,r){return!e.has(r)},h=r.filter(s),u=n.filter(s),l=o.filter(s);return new a(u,l,h,t.getDims())},e.normalize=function(t,e){var r,n;void 0===e&&(e="l2");var o=u[e],s=new Map;t.forEach((function(t,e,r){var n=s.get(e)||[];n.push(r),s.set(e,n)}));var h=new a([],[],[],t.getDims()),l=function(e){for(var r=s.get(e).sort(),n=r.map((function(r){return t.get(e,r)})),i=o(n),a=0;a<i.length;a++)h.set(e,r[a],i[a])};try{for(var f=i(s.keys()),c=f.next();!c.done;c=f.next())l(c.value)}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}return h};var u=((n={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map((function(t){return t/e}))},n.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map((function(t){return t/e}))},n.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map((function(t){return Math.sqrt(Math.pow(t,2)/e)}))},n);function l(t,e,r){for(var n=new Set,o=[],i=[],s=[],h=function(n,h){o.push(n),i.push(h);var a=r(t.get(n,h),e.get(n,h));s.push(a)},u=t.getValues(),l=t.getRows(),f=t.getCols(),c=0;c<u.length;c++){var p=(d=l[c])+":"+(y=f[c]);n.add(p),h(d,y)}var m=e.getValues(),g=e.getRows(),w=e.getCols();for(c=0;c<m.length;c++){var d,y;p=(d=g[c])+":"+(y=w[c]),n.has(p)||h(d,y)}var v=[t.nRows,t.nCols];return new a(o,i,s,v)}e.getCSR=function(t){var e=[];t.forEach((function(t,r,n){e.push({value:t,row:r,col:n})})),e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}));for(var r=[],n=[],o=[],i=-1,s=0;s<e.length;s++){var h=e[s],a=h.row,u=h.col,l=h.value;a!==i&&(i=a,o.push(s)),r.push(u),n.push(l)}return{indices:r,values:n,indptr:o}}},760:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r(378)),s=o(r(686)),h=o(r(320)),a=o(r(517));e.makeNNDescent=function(t,e){return function(r,n,o,s,h,u,l,f){void 0===s&&(s=10),void 0===h&&(h=50),void 0===u&&(u=.001),void 0===l&&(l=.5),void 0===f&&(f=!0);for(var c=r.length,p=i.makeHeap(r.length,o),m=0;m<r.length;m++)for(var g=i.rejectionSample(o,r.length,e),w=0;w<g.length;w++){var d=t(r[m],r[g[w]]);i.heapPush(p,m,d,g[w],1),i.heapPush(p,g[w],d,m,1)}if(f)for(var y=0;y<n.length;y++)for(m=0;m<n[y].length&&!(n[y][m]<0);m++)for(w=m+1;w<n[y].length&&!(n[y][w]<0);w++)d=t(r[n[y][m]],r[n[y][w]]),i.heapPush(p,n[y][m],d,n[y][w],1),i.heapPush(p,n[y][w],d,n[y][m],1);for(y=0;y<s;y++){var v=i.buildCandidates(p,c,o,h,e),b=0;for(m=0;m<c;m++)for(w=0;w<h;w++){var M=Math.floor(v[0][m][w]);if(!(M<0||a.tauRand(e)<l))for(var x=0;x<h;x++){var S=Math.floor(v[0][m][x]),E=v[2][m][w],R=v[2][m][x];S<0||!E&&!R||(d=t(r[M],r[S]),b+=i.heapPush(p,M,d,S,1),b+=i.heapPush(p,S,d,M,1))}}if(b<=u*o*r.length)break}return i.deheapSort(p)}},e.makeInitializations=function(t){return{initFromRandom:function(e,r,n,o,s){for(var h=0;h<n.length;h++)for(var u=a.rejectionSample(e,r.length,s),l=0;l<u.length;l++)if(!(u[l]<0)){var f=t(r[u[l]],n[h]);i.heapPush(o,h,f,u[l],1)}},initFromTree:function(e,r,n,o,s){for(var a=0;a<n.length;a++)for(var u=h.searchFlatTree(n[a],e,s),l=0;l<u.length;l++){if(u[l]<0)return;var f=t(r[u[l]],n[a]);i.heapPush(o,a,f,u[l],1)}}}},e.makeInitializedNNSearch=function(t){return function(e,r,o,h){for(var a,u,l=s.getCSR(r),f=l.indices,c=l.indptr,p=0;p<h.length;p++)for(var m=new Set(o[0][p]);;){var g=i.smallestFlagged(o,p);if(-1===g)break;var w=f.slice(c[g],c[g+1]);try{for(var d=n(w),y=d.next();!y.done;y=d.next()){var v=y.value;if(v!==g&&-1!==v&&!m.has(v)){var b=t(e[v],h[p]);i.uncheckedHeapPush(o,p,b,v,1),m.add(v)}}}catch(t){a={error:t}}finally{try{y&&!y.done&&(u=d.return)&&u.call(d)}finally{if(a)throw a.error}}}return o}},e.initializeSearch=function(t,e,r,o,s,h,a){var u,l,f=i.makeHeap(r.length,o);if(s(o,e,r,f,a),t)try{for(var c=n(t),p=c.next();!p.done;p=c.next())h(p.value,e,r,f,a)}catch(t){u={error:t}}finally{try{p&&!p.done&&(l=c.return)&&l.call(c)}finally{if(u)throw u.error}}return f}},320:function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var h=s(r(517)),a=function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n};function u(t,e,r,n,o){if(void 0===r&&(r=30),e.length>r){var i=function(t,e,r){var n=t[0].length,o=h.tauRandInt(e.length,r),i=h.tauRandInt(e.length,r);i=(i+=o===i?1:0)%e.length;for(var s=e[o],a=e[i],u=0,l=h.zeros(n),f=0;f<l.length;f++)l[f]=t[s][f]-t[a][f],u-=l[f]*(t[s][f]+t[a][f])/2;var c=0,p=0,m=h.zeros(e.length);for(f=0;f<e.length;f++){for(var g=u,w=0;w<n;w++)g+=l[w]*t[e[f]][w];0===g?(m[f]=h.tauRandInt(2,r),0===m[f]?c+=1:p+=1):g>0?(m[f]=0,c+=1):(m[f]=1,p+=1)}var d=h.zeros(c),y=h.zeros(p);for(c=0,p=0,f=0;f<m.length;f++)0===m[f]?(d[c]=e[f],c+=1):(y[p]=e[f],p+=1);return{indicesLeft:d,indicesRight:y,hyperplane:l,offset:u}}(t,e,o),s=i.indicesLeft,a=i.indicesRight,l=i.hyperplane,f=i.offset;return{leftChild:u(t,s,r,n+1,o),rightChild:u(t,a,r,n+1,o),isLeaf:!1,hyperplane:l,offset:f}}return{indices:e,isLeaf:!0}}function l(t,e,r,n,i,s,h){var a;if(t.isLeaf)return n[s][0]=-h,(a=i[h]).splice.apply(a,o([0,t.indices.length],t.indices)),{nodeNum:s,leafNum:h+=1};e[s]=t.hyperplane,r[s]=t.offset,n[s][0]=s+1;var u=s,f=l(t.leftChild,e,r,n,i,s+1,h);return s=f.nodeNum,h=f.leafNum,n[u][1]=s+1,{nodeNum:(f=l(t.rightChild,e,r,n,i,s+1,h)).nodeNum,leafNum:f.leafNum}}function f(t){return t.isLeaf?1:1+f(t.leftChild)+f(t.rightChild)}function c(t){return t.isLeaf?1:c(t.leftChild)+c(t.rightChild)}function p(t,e,r,n){for(var o=e,i=0;i<r.length;i++)o+=t[i]*r[i];return 0===o?h.tauRandInt(2,n):o>0?0:1}e.FlatTree=a,e.makeForest=function(t,e,r,n){var o=Math.max(10,e);return h.range(r).map((function(e,r){return function(t,e,r,n){return void 0===e&&(e=30),u(t,h.range(t.length),e,r,n)}(t,o,r,n)})).map((function(t){return function(t,e){var r=f(t),n=c(t),o=h.range(r).map((function(){return h.zeros(t.hyperplane?t.hyperplane.length:0)})),i=h.zeros(r),s=h.range(r).map((function(){return[-1,-1]})),u=h.range(n).map((function(){return h.range(e).map((function(){return-1}))}));return l(t,o,i,s,u,0,0),new a(o,i,s,u)}(t,o)}))},e.makeLeafArray=function(t){var e,r;if(t.length>0){var n=[];try{for(var s=i(t),h=s.next();!h.done;h=s.next()){var a=h.value;n.push.apply(n,o(a.indices))}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n}return[[-1]]},e.searchFlatTree=function(t,e,r){for(var n=0;e.children[n][0]>0;)n=0===p(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1];var o=-1*e.children[n][0];return e.indices[o]}},364:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function h(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new r((function(e){e(t.value)})).then(s,h)}a((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function h(i){return function(h){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,h])}}},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},h=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=h(r(378)),l=h(r(686)),f=h(r(760)),c=h(r(320)),p=h(r(517)),m=a(r(726)),g=1e-5,w=.001,d=function(){function t(t){void 0===t&&(t={});var e=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=y,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new v;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}}))}))},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,o=r.tail,i=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=o,this.optimizationState.epochsPerSample=i,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=f.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=f.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],o=new l.SparseMatrix([],[],[],n),i=0;i<e.length;i++)for(var s=e[i],h=r[i],a=0;a<s.length;a++){var u=s[a],f=h[a];f>0&&o.set(i,u,f)}var c=l.transpose(o);return l.maximum(o,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var o=f.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),i=this.search(r,this.searchGraph,o,t),s=u.deheapSort(i),h=s.indices,a=s.weights;h=h.map((function(t){return t.slice(0,e.nNeighbors)})),a=a.map((function(t){return t.slice(0,e.nNeighbors)}));var c=Math.max(0,this.localConnectivity-1),m=this.smoothKNNDistance(a,this.nNeighbors,c),g=m.sigmas,w=m.rhos,d=this.computeMembershipStrengths(h,a,g,w),y=d.rows,v=d.cols,b=d.vals,M=[t.length,r.length],x=new l.SparseMatrix(y,v,b,M),S=l.normalize(x,"l1"),E=l.getCSR(S),k=t.length,N=R(p.reshape2d(E.indices,k,this.nNeighbors),p.reshape2d(E.values,k,this.nNeighbors),this.embedding),z=this.nEpochs?this.nEpochs/3:x.nRows<=1e4?100:30,A=x.getValues().reduce((function(t,e){return e>t?e:t}),0);x=x.map((function(t){return t<A/z?0:t})),x=l.eliminateZeros(x);var C=this.makeEpochsPerSample(x.getValues(),z),I=x.getRows(),P=x.getCols();return this.assignOptimizationStateParameters({headEmbedding:N,tailEmbedding:this.embedding,head:I,tail:P,currentEpoch:0,nEpochs:z,nVertices:x.getDims()[1],epochsPerSample:C}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,n=this.nNeighbors,o=f.makeNNDescent(r,this.random),i=5+Math.floor(.5==(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),s=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=c.makeForest(t,n,i,this.random);var h=o(t,c.makeLeafArray(this.rpForest),n,s);return{knnIndices:h.indices,knnDistances:h.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this,o=n.knnIndices,i=void 0===o?[]:o,s=n.knnDistances,h=void 0===s?[]:s,a=n.localConnectivity,u=this.smoothKNNDistance(h,e,a),f=u.sigmas,c=u.rhos,p=this.computeMembershipStrengths(i,h,f,c),m=p.rows,g=p.cols,w=p.vals,d=[t.length,t.length],y=new l.SparseMatrix(m,g,w,d),v=l.transpose(y),b=l.pairwiseMultiply(y,v),M=l.subtract(l.add(y,v),b),x=l.multiplyScalar(M,r),S=l.multiplyScalar(b,1-r);return l.add(x,S)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var o=S(t,e,n,r);return E(o=l.eliminateZeros(o))},t.prototype.smoothKNNDistance=function(t,e,r,n,o){void 0===r&&(r=1),void 0===n&&(n=64),void 0===o&&(o=1);for(var i=Math.log(e)/Math.log(2)*o,s=p.zeros(t.length),h=p.zeros(t.length),a=0;a<t.length;a++){var u=0,l=1/0,f=1,c=t[a],m=c.filter((function(t){return t>0}));if(m.length>=r){var d=Math.floor(r),y=r-d;d>0?(s[a]=m[d-1],y>g&&(s[a]+=y*(m[d]-m[d-1]))):s[a]=y*m[0]}else m.length>0&&(s[a]=p.max(m));for(var v=0;v<n;v++){for(var b=0,M=1;M<t[a].length;M++){var x=t[a][M]-s[a];b+=x>0?Math.exp(-x/f):1}if(Math.abs(b-i)<g)break;b>i?f=(u+(l=f))/2:(u=f,l===1/0?f*=2:f=(u+l)/2)}if(h[a]=f,s[a]>0){var S=p.mean(c);h[a]<w*S&&(h[a]=w*S)}else{var E=p.mean(t.map(p.mean));h[a]<w*E&&(h[a]=w*E)}}return{sigmas:h,rhos:s}},t.prototype.computeMembershipStrengths=function(t,e,r,n){for(var o=t.length,i=t[0].length,s=p.zeros(o*i),h=p.zeros(o*i),a=p.zeros(o*i),u=0;u<o;u++)for(var l=0;l<i;l++){var f=0;-1!==t[u][l]&&(f=t[u][l]===u?0:e[u][l]-n[u]<=0?1:Math.exp(-(e[u][l]-n[u])/r[u]),s[u*i+l]=u,h[u*i+l]=t[u][l],a[u*i+l]=f)}return{rows:s,cols:h,vals:a}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),o=0,i=0;i<n.length;i++){var s=n[i];o<n[i]&&(o=s)}var h=this.graph.map((function(t){return t<o/e?0:t}));this.embedding=p.zeros(h.nRows).map((function(){return p.zeros(r).map((function(){return 20*p.tauRand(t.random)-10}))}));var a=[],u=[],l=[],f=h.getAll();for(i=0;i<f.length;i++){var c=f[i];c.value&&(a.push(c.value),l.push(c.row),u.push(c.col))}return{head:u,tail:l,epochsPerSample:this.makeEpochsPerSample(a,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=p.filled(t.length,-1),n=p.max(t),o=t.map((function(t){return t/n*e}));return o.forEach((function(t,n){t>0&&(r[n]=e/o[n])})),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,r=t.learningRate,n=t.negativeSampleRate,o=this.optimizationState,i=o.epochsPerSample,h=o.headEmbedding,a=o.tailEmbedding,u=h[0].length,l=h.length===a.length,f=i.map((function(t){return t/n})),c=s(f),p=s(i);this.assignOptimizationStateParameters({epochOfNextSample:p,epochOfNextNegativeSample:c,epochsPerNegativeSample:f,moveOther:l,initialAlpha:r,alpha:r,gamma:e,dim:u})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,o=r.tail,i=r.epochsPerSample,s=this.getNEpochs(),h=this.graph.nCols,a=x(this.spread,this.minDist),u=a.a,l=a.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:o,epochsPerSample:i,a:u,b:l,nEpochs:s,nVertices:h})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,o=e.headEmbedding,i=e.tailEmbedding,s=e.epochsPerSample,h=e.epochOfNextSample,a=e.epochOfNextNegativeSample,u=e.epochsPerNegativeSample,l=e.moveOther,f=e.initialAlpha,c=e.alpha,m=e.gamma,g=e.a,w=e.b,d=e.dim,y=e.nEpochs,v=e.nVertices,x=0;x<s.length;x++)if(!(h[x]>t)){var S=r[x],E=n[x],R=o[S],k=i[E],N=M(R,k),z=0;N>0&&(z=-2*g*w*Math.pow(N,w-1),z/=g*Math.pow(N,w)+1);for(var A=0;A<d;A++){var C=b(z*(R[A]-k[A]),4);R[A]+=C*c,l&&(k[A]+=-C*c)}h[x]+=s[x];for(var I=Math.floor((t-a[x])/u[x]),P=0;P<I;P++){var F=p.tauRandInt(v,this.random),_=i[F],T=M(R,_),O=0;if(T>0)O=2*m*w,O/=(.001+T)*(g*Math.pow(T,w)+1);else if(S===F)continue;for(A=0;A<d;A++)C=4,O>0&&(C=b(O*(R[A]-_[A]),4)),R[A]+=C*c}a[x]+=I*u[x]}return e.alpha=f*(1-t/y),e.currentEpoch+=1,o},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise((function(r,i){var s=function(){return n(e,void 0,void 0,(function(){var e,n,h,a,u,l;return o(this,(function(o){try{if(e=this.optimizationState,n=e.nEpochs,h=e.currentEpoch,this.embedding=this.optimizeLayoutStep(h),a=this.optimizationState.currentEpoch,u=!1===t(a),l=a===n,u||l)return[2,r(l)];setTimeout((function(){return s()}),0)}catch(t){i(t)}return[2]}))}))};setTimeout((function(){return s()}),0)}))},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,o=n.nEpochs,i=n.currentEpoch;r=this.optimizeLayoutStep(i);var s=this.optimizationState.currentEpoch,h=!1===t(s);e=s===o||h}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function y(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}e.UMAP=d,e.euclidean=y,e.cosine=function(t,e){for(var r=0,n=0,o=0,i=0;i<t.length;i++)r+=t[i]*e[i],n+=Math.pow(t[i],2),o+=Math.pow(e[i],2);return 0===n&&0===o?0:0===n||0===o?1:1-r/Math.sqrt(n*o)};var v=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function b(t,e){return t>e?e:t<-e?-e:t}function M(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function x(t,e){var r=p.linear(0,3*t,300).map((function(t){return t<e?1:t})),n=p.zeros(r.length).map((function(n,o){return r[o]>=e?Math.exp(-(r[o]-e)/t):n})),o={x:r,y:n},s=m.default(o,(function(t){var e=i(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}}),{damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01}).parameterValues,h=i(s,2);return{a:h[0],b:h[1]}}function S(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map((function(t,o,i){return-1===e[o]||-1===e[i]?t*Math.exp(-r):e[o]!==e[i]?t*Math.exp(-n):t}))}function E(t){t=l.normalize(t,"max");var e=l.transpose(t),r=l.pairwiseMultiply(e,t);return t=l.add(t,l.subtract(e,r)),l.eliminateZeros(t)}function R(t,e,r){for(var n=p.zeros(t.length).map((function(t){return p.zeros(r[0].length)})),o=0;o<t.length;o++)for(var i=0;i<t[0].length;i++)for(var s=0;s<r[0].length;s++){var h=t[o][i];n[o][s]+=e[o][i]*r[h][s]}return n}e.findABParams=x,e.fastIntersection=S,e.resetLocalConnectivity=E,e.initTransform=R},517:function(t,e){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};function n(t,e){return Math.floor(e()*t)}function o(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function i(t,e){return o(t).map((function(){return e}))}function s(t){return i(t,0)}function h(t){return t.reduce((function(t,e){return t+e}))}Object.defineProperty(e,"__esModule",{value:!0}),e.tauRandInt=n,e.tauRand=function(t){return t()},e.norm=function(t){var e,n,o=0;try{for(var i=r(t),s=i.next();!s.done;s=i.next()){var h=s.value;o+=Math.pow(h,2)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return Math.sqrt(o)},e.empty=o,e.range=function(t){return o(t).map((function(t,e){return e}))},e.filled=i,e.zeros=s,e.ones=function(t){return i(t,1)},e.linear=function(t,e,r){return o(r).map((function(n,o){return t+o*((e-t)/(r-1))}))},e.sum=h,e.mean=function(t){return h(t)/t.length},e.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},e.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e},e.rejectionSample=function(t,e,r){for(var o=s(t),i=0;i<t;i++)for(var h=!0;h;){for(var a=n(e,r),u=!1,l=0;l<i;l++)if(a===o[l]){u=!0;break}u||(h=!1),o[i]=a}return o},e.reshape2d=function(t,e,r){var n=[],o=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var i=0;i<e;i++){for(var s=[],h=0;h<r;h++)s.push(t[o]),o+=1;n.push(s)}return n}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=r(221);function e(t,e){return Math.sqrt(function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}(t,e))}var n=r(754),o=r(485),i=r.n(o);class s{constructor(){this.children=[],this.height=0,this.size=1,this.index=-1,this.isLeaf=!1}cut(t){if("number"!=typeof t)throw new TypeError("threshold must be a number");if(t<0)throw new RangeError("threshold must be a positive number");let e=[this];const r=[];for(;e.length>0;){const n=e.shift();t>=n.height?r.push(n):e=e.concat(n.children)}return r}group(t){if(!Number.isInteger(t)||t<1)throw new RangeError("groups must be a positive integer");const e=new(i())(((t,e)=>e.height-t.height));for(e.push(this);e.size()<t;){var r=e.pop();if(0===r.children.length)break;r.children.forEach((t=>e.push(t)))}var n=new s;return n.children=e.toArray(),n.height=this.height,n}traverse(t){!function t(e,r){if(r(e),e.children)for(const n of e.children)t(n,r)}(this,t)}indices(){const t=[];return this.traverse((e=>{e.isLeaf&&t.push(e.index)})),t}}function h(t,e){return Math.min(t,e)}function a(t,e){return Math.max(t,e)}function u(t,e,r,n,o){return n/(n+o)*t+o/(n+o)*e}function l(t,e){return(t+e)/2}function f(t,e,r,n,o){return n/(n+o)*t+o/(n+o)*e+-n*o/(n+o)**2*r}function c(t,e,r){return t/2+e/2-r/4}function p(t,e,r,n,o,i){return(n+i)/(n+o+i)*t+(o+i)/(n+o+i)*e+-i/(n+o+i)*r}function m(t,e,r,n,o,i){const s=(n+i)/(n+o+i),h=(o+i)/(n+o+i),a=-i/(n+o+i);return Math.sqrt(s*t*t+h*e*e+a*r*r)}function g(t,r={}){const{distanceFunction:o=e,method:i="complete",isDistanceMatrix:g=!1}=r;let y;g||(t=function(t,e){const r=function(t){const e=[];for(let r=0;r<t;r++){const r=[];e.push(r);for(let e=0;e<t;e++)r.push(0)}return e}(t.length);for(let n=0;n<t.length;n++)for(let o=0;o<=n;o++)r[n][o]=e(t[n],t[o]),r[o][n]=r[n][o];return r}(t,o));let v=new n.Z(t);const b=v.rows;if("string"==typeof i)switch(i.toLowerCase()){case"single":y=h;break;case"complete":y=a;break;case"average":case"upgma":y=u;break;case"wpgma":y=l;break;case"centroid":case"upgmc":y=f;break;case"median":case"wpgmc":y=c;break;case"ward":y=p;break;case"ward2":y=m;break;default:throw new RangeError(`unknown clustering method: ${i}`)}else if("function"!=typeof i)throw new TypeError("method must be a string or function");let M=[];for(let t=0;t<b;t++){const e=new s;e.isLeaf=!0,e.index=t,M.push(e)}for(let t=0;t<b-1;t++){const[t,e,r]=w(v),o=M[t],i=M[e],h=new s;h.size=o.size+i.size,h.children.push(o,i),h.height=r;const a=[h],u=new n.Z(v.rows-1,v.rows-1),l=r=>d(r,Math.min(t,e),Math.max(t,e));for(let n=1;n<u.rows;n++){const s=l(n),h=M[s];a.push(h);for(let a=0;a<n;a++)if(0===a){const l=y(v.get(t,s),v.get(s,e),r,o.size,i.size,h.size);u.set(n,a,l),u.set(a,n,l)}else{const t=v.get(s,l(a));u.set(n,a,t),u.set(a,n,t)}}M=a,v=u}return M[0]}function w(t){let e=1/0,r=0,n=0;for(let o=1;o<t.rows;o++)for(let i=0;i<o;i++)t.get(o,i)<e&&(e=t.get(o,i),r=o,n=i);return[r,n,e]}function d(t,e,r){return(t-=1)>=e&&t++,t>=r&&t++,t}function y(t){const e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}self.onmessage=function(e){if("buildEmbeddingNetwork"===e.data.method){const{id:r,param:n}=e.data,{people:o,params:i}=n;try{const e=function(e,{clusterEmbeddingComponents:r=5,clusterNearestNeighbours:n=8,width:o=800,height:i=400,Z:s=75}){const h=(e=Object.keys(e).map((t=>({uid:t,username:e[t].username,skills:e[t].skills||[]})))).map((t=>t.uid)),a=function(t,e){const r=t.nodes.length,n=t.nodes.map((t=>t.id)),o=[];for(let t=0;t<r;t+=1)o[t]=new Float32Array(r),o[t][t]=e[t].skills.length;return t.links.forEach((t=>{const e=n.indexOf(t.source),r=n.indexOf(t.target);o[r][e]=t.value,o[e][r]=t.value})),o}(function(t){const e=t.map((t=>({id:t.uid,group:1}))),r=[];for(let e=0;e<t.length-1;e+=1)for(let n=e+1;n<t.length;n+=1){const o=t[e],i=t[n],s=o.skills,h=i.skills,a=s.reduce(((t,e)=>t+h.includes(e)?1:0),0);a>0&&r.push({source:o.uid,target:i.uid,value:a})}return{nodes:e,links:r}}(e),e),u=function(t){const e=[];let r=0;for(let n=0;n<t.length;n+=1)t[n].reduce(((t,e)=>t+e))>0&&(e[r]=n,r+=1);return e}(a),l=function(t,e){const r=new Array(e.length);for(let n=0;n<e.length;n+=1)r[n]=t[e[n]];return r}(a,u),f=new t.u({nComponents:2}).fit(l),c=function(t){let e=0,r=0,n=0,o=0,i=0;for(let n=0;n<t.length;n+=1)e+=t[n][0],r+=t[n][1];e/=t.length,r/=t.length;for(let s=0;s<t.length;s+=1)n+=(t[s][0]-e)**2,o+=(t[s][1]-r)**2,i+=(t[s][0]-e)*(t[s][1]-r);const s=(n+o)/2,h=n*o-i**2,a=Math.sqrt(s**2-h),u=s+a,l=s-a;let f,c;return u>l?(f=y([i,u-n]),c=y([i,l-n])):(f=y([i,l-n]),c=y([i,u-n])),{mean:[e,r],evec1:f,evec2:c}}(f),{mean:p,evec1:m,evec2:w}=c;for(let t=0;t<f.length;t+=1){let[e,r]=f[t];e-=p[0],r-=p[1],f[t][0]=e*m[0]+r*m[1],f[t][1]=e*w[0]+r*w[1]}!function(t,e,r){const n=t.length,o=e[0].length,i=new Array(n);for(let t=0;t<n;t+=1)i[t]=new Float32Array(n);for(let t=0;t<n;t+=1)for(let r=t;r<n;r+=1){let n=0;for(let i=0;i<o;i+=1)n+=(e[t][i]-e[r][i])**2;i[t][r]=n,i[r][t]=n}for(let e=0;e<n;e+=1){const o=(s=i[e],h=(t,e)=>[t,e],Array.prototype.map.call(s,h)).sort(((t,e)=>e[0]-t[0]));for(let i=0;i<n-r;i+=1)t[e][o[i][1]]=0}var s,h}(l,new t.u({nComponents:r}).fit(l),n);const d=JSON.parse(JSON.stringify(a)),v=[];let b=0;const M=o/i,x=.9*o/s/2;for(let t=0;t<a.length;t+=1){if(u.indexOf(t)<0){const e=2*Math.PI*(b/(a.length-u.length));v[t]=[x*Math.cos(e),x/M*Math.sin(e)],b+=1}for(let e=0;e<a.length;e+=1)d[t][e]=0}for(let t=0;t<u.length;t+=1){v[u[t]]=f[t];for(let e=0;e<u.length;e+=1)d[u[t]][u[e]]=l[t][e]}const S=function(t,e,r,n,o,i){const s=[],h=[],a=t.length;for(let u=0;u<a;u+=1){s[u]={id:i[u],x:r/2+o*e[u][0],y:n/2+o*e[u][1],vx:0,vy:0,classes:`brainweb-${i[u]}`};for(let e=0;e<a;e+=1)u!==e&&t[u][e]>0&&h.push({source:i[u],target:i[e],value:t[u][e]})}return{nodes:s,links:h}}(d,v,o,i,s,h);return function(t,e){const r=g(t,{method:"ward"}),n=~~(t.length**1/2);r.group(n).children.forEach(((t,r)=>{t.traverse((t=>{t.isLeaf&&(e.nodes[t.index].group=r)}))}))}(a,S),S}(o,i);postMessage({id:r,result:e})}catch(t){postMessage({id:r,error:t})}}}})()})();